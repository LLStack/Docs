(window.webpackJsonp=window.webpackJsonp||[]).push([[53],{371:function(s,t,a){"use strict";a.r(t);var e=a(20),r=Object(e.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"https-设置"}},[s._v("HTTPS 设置")]),s._v(" "),t("h2",{attrs:{id:"olstack-ols-版本"}},[s._v("OLStack - OLS 版本")]),s._v(" "),t("h3",{attrs:{id:"配置ssl证书"}},[s._v("配置SSL证书")]),s._v(" "),t("p",[s._v("首先得确保相关域名的虚拟主机已经创建，并且解析已经做对。 将使用 ACME 自动创建 Let's Encrypt 免费SSL证书。")]),s._v(" "),t("h4",{attrs:{id:"安装acme"}},[s._v("安装ACME")]),s._v(" "),t("p",[s._v("仅 "),t("strong",[s._v("第一次")]),s._v(" 运行需要安装ACME，带电子邮件通知运行：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("./bin/acme.sh "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--install")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-email")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("EMAIL_ADDR"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("\n")])])]),t("p",[s._v("例如：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("./bin/acme.sh "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--install")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-email")]),s._v(" cert@mf8.biz\n")])])]),t("p",[s._v("不需要电子邮件通知运行：")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("./bin/acme.sh --install --no-email\n")])])]),t("h4",{attrs:{id:"申请证书"}},[s._v("申请证书")]),s._v(" "),t("p",[s._v("在此命令中使用根域名，不需要填写 "),t("code",[s._v("www.")]),s._v(" 会自动添加"),t("code",[s._v("www.")]),s._v("：")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("./bin/acme.sh -domain <yourdomain.com>\n")])])]),t("p",[s._v("例如：")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[s._v("./bin/acme.sh "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-domain")]),s._v(" mf8.biz\n")])])]),t("p",[s._v("则会自动签发"),t("code",[s._v("www.mf8.biz")]),s._v(" 和 "),t("code",[s._v("mf8.biz")]),s._v(" 两个证书")]),s._v(" "),t("h2",{attrs:{id:"llstack-lsws-版"}},[s._v("LLStack - LSWS 版")]),s._v(" "),t("p",[s._v("本文将介绍普通HTTP虚拟主机如何升级为HTTPS，以及 LiteSpeed HTTPS 的进阶设置。")]),s._v(" "),t("p",[s._v("一、登陆 LiteSpeed 管理控制台。  一般是 , "),t("code",[s._v("https://<你的公网ip>:7080")]),s._v(" ，")]),s._v(" "),t("p",[s._v("如果不知道账号密码，可以在 SSH 中输入："),t("code",[s._v("cat /root/defaulthtpasswd")]),s._v(" 。")]),s._v(" "),t("p",[s._v("二、进入 "),t("strong",[s._v("Configuration")]),s._v(" —— "),t("strong",[s._v("Virtual Hosts")]),s._v("，点击要配置HTTPS的域名点击 "),t("strong",[s._v("View/Edit")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://pics.mf8.biz/xsj/2019/2/1549437882866.png",alt:"enter description here"}})]),s._v(" "),t("p",[s._v("三、点击 "),t("strong",[s._v("SSL")]),s._v(" ，然后再每个项目组进行编辑 "),t("strong",[s._v("Edit")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://pics.mf8.biz/xsj/2019/2/1549438023001.png",alt:"enter description here"}})]),s._v(" "),t("p",[s._v("四、"),t("strong",[s._v("SSL Private Key & Certificate")]),s._v(" 我们这样编辑（这里的证书可以是任意证书，自签的都可以，到时候我们虚拟主机上的SSL设置会覆盖监听的SSL）。 SSL 格式按照 Nginx 模式下载就行，PEM格式。")]),s._v(" "),t("p",[s._v("如果 CA 中间证书和域名证书是分离的，那么 "),t("code",[s._v("Chained Certificate")]),s._v(" 需要设置为 "),t("code",[s._v("No")]),s._v("，然后CA 中间证书填写在 CA Certificate File 栏。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://pics.mf8.biz/xsj/2019/2/1549438163676.png",alt:"enter description here"}})]),s._v(" "),t("p",[s._v("五、为了提升安全性，我们生成一个 生成赫尔曼（DH）密钥。")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /home/"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("你的域名"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("/ssl/\nopenssl dhparam "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-out")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("你的域名"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(".pem "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v(" \n")])])]),t("p",[t("strong",[s._v("示例：")])]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("cd")]),s._v(" /home/llstack.com/ssl/\nopenssl dhparam "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-out")]),s._v(" llstack.com.dh.pem "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")]),s._v(" \n")])])]),t("p",[s._v("六、修改 "),t("strong",[s._v("Virtual Host SSL Protocol")]),s._v(" :")]),s._v(" "),t("p",[s._v("1.Protocol Version 即 协议版本，不建议勾选 SSL v3.0。  为了更高的安全性，也可以考虑不勾选 TLS v1.0。")]),s._v(" "),t("p",[s._v("2.Ciphers，填写 "),t("code",[s._v("TLS13-AES-256-GCM-SHA384:TLS13-CHACHA20-POLY1305-SHA256:TLS13-AES-128-GCM-SHA256:TLS13-AES-128-CCM-8-SHA256:TLS13-AES-128-CCM-SHA256:EECDH+CHACHA20:EECDH+CHACHA20-draft:EECDH+ECDSA+AES128:EECDH+aRSA+AES128:RSA+AES128:EECDH+ECDSA+AES256:EECDH+aRSA+AES256:RSA+AES256:EECDH+ECDSA+3DES:EECDH+aRSA+3DES:RSA+3DES:!MD5;")])]),s._v(" "),t("p",[s._v("3.Enable DH Key Exchange，勾选为 "),t("code",[s._v("Yes")])]),s._v(" "),t("p",[s._v("4.DH Parameter，填写第五步生成的文件，例如 "),t("code",[s._v("/home/llstack.com/ssl/llstack.com.dh.pem")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://pics.mf8.biz/xsj/2019/2/1549440558108.png",alt:"enter description here"}})]),s._v(" "),t("p",[s._v("七、"),t("strong",[s._v("Security & Features")]),s._v(" ，参照图片填写。  QUIC 推荐开启。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://pics.mf8.biz/xsj/2019/2/1549440830920.png",alt:"enter description here"}})]),s._v(" "),t("p",[s._v("八、进入 "),t("strong",[s._v("Configuration")]),s._v(" —— "),t("strong",[s._v("Listeners")]),s._v("，对名叫 "),t("code",[s._v("HTTPS")]),s._v(" 的监听器进行编辑 "),t("code",[s._v("View/Edit")]),t("img",{attrs:{src:"https://pics.mf8.biz/xsj/2019/2/1549717505006.png",alt:"enter description here"}})]),s._v(" "),t("p",[s._v("九、在 "),t("strong",[s._v("Virtual Host Mappings")]),s._v(" 处，选择 "),t("strong",[s._v("ADD")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://pics.mf8.biz/xsj/2019/2/1549441093401.png",alt:"enter description here"}})]),s._v(" "),t("p",[s._v("十、选择要使用的 Virtual Host ，然后输入域名。 点击 "),t("strong",[s._v("Save")]),s._v(" 保存。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://pics.mf8.biz/xsj/2019/2/1549441146539.png",alt:"enter description here"}})]),s._v(" "),t("p",[s._v("十一、我估计你肯定忍上门的提示很久了，选择就可以点 "),t("code",[s._v("Graceful Restart.")]),s._v(" 进行平滑重启了。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://pics.mf8.biz/xsj/2019/2/1549441217770.png",alt:"enter description here"}})])])}),[],!1,null,null,null);t.default=r.exports}}]);