(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{374:function(t,a,e){"use strict";e.r(a);var s=e(20),r=Object(s.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"防火墙设置"}},[t._v("防火墙设置")]),t._v(" "),a("p",[t._v("服务器的防火墙设置非常软件，有些时候服务器和端口的无法启用很可能是防火墙没有及时设置完成的缘故。")]),t._v(" "),a("p",[t._v("目前 LLStack 基于 CentOS 7，OLStack 则可以在任何可以运行 Docker 的宿主机系统上运行。")]),t._v(" "),a("p",[t._v("这里介绍常见的两个简单 Linux 防火墙设置软件的教程。分别是 Firewall 和 UFW，他们都比 iptables 更加简单易学。")]),t._v(" "),a("p",[t._v("Debian、Ubuntu、Deepin、ArchLinux 等推荐使用 UFW。")]),t._v(" "),a("p",[t._v("RHEL、CentOS、Oracle Linux、Fedora、AliyunLinux 推荐使用 Firewall。")]),t._v(" "),a("h2",{attrs:{id:"ufw"}},[t._v("UFW")]),t._v(" "),a("p",[t._v("UFW，即简单防火墙uncomplicated firewall，是一个 Arch Linux、Debian 或 Ubuntu 中管理防火墙规则的前端。 UFW 通过命令行使用（尽管它有可用的 GUI），它的目的是使防火墙配置简单（即不复杂uncomplicated）。")]),t._v(" "),a("h3",{attrs:{id:"安装"}},[t._v("安装")]),t._v(" "),a("p",[a("strong",[t._v("ArchLinux：")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("sudo")]),t._v(" pacman "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-S")]),t._v(" ufw\n")])])]),a("p",[a("strong",[t._v("Debian/Ubuntu：")])]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" update \n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("apt-get")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("install")]),t._v(" ufw "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-y")]),t._v("\n")])])]),a("h3",{attrs:{id:"设置默认规则"}},[t._v("设置默认规则")]),t._v(" "),a("p",[t._v("大多数系统只需要打开少量的端口接受传入连接，并且关闭所有剩余的端口。 从一个简单的规则基础开始，"),a("code",[t._v("ufw default")]),t._v("命令可以用于设置对传入和传出连接的默认响应动作。 要拒绝所有传入并允许所有传出连接，那么运行：")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("ufw default allow outgoing\nufw default deny incoming\n")])])]),a("h3",{attrs:{id:"开启端口"}},[t._v("开启端口")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("ufw allow "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\nufw allow "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("443")]),t._v("\n")])])]),a("p",[t._v("这里的 "),a("code",[t._v("80")]),t._v(","),a("code",[t._v("443")]),t._v(" 即要开启的端口，我们可以自定义。")]),t._v(" "),a("p",[t._v("也可以是具体的TCP或者UDP协议：")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("ufw allow "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("/tcp\nufw allow "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("443")]),t._v("/tcp\nufw allow "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("443")]),t._v("/udp\n")])])]),a("h3",{attrs:{id:"关闭端口"}},[t._v("关闭端口")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("ufw deny "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("\nufw deny "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("443")]),t._v("\n")])])]),a("h3",{attrs:{id:"批量添加区间端口"}},[t._v("批量添加区间端口")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("ufw allow "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4400")]),t._v(":4600/udp\nufw allow "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4400")]),t._v(":4600/tcp\n")])])]),a("h3",{attrs:{id:"启动防火墙"}},[t._v("启动防火墙")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("ufw "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("enable")]),t._v("\n")])])]),a("h3",{attrs:{id:"关闭防火墙"}},[t._v("关闭防火墙")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("ufw disable\n")])])]),a("h2",{attrs:{id:"firewall"}},[t._v("Firewall")]),t._v(" "),a("p",[t._v("Firewall 是 CentOS 7 开始自带的防火墙服务以取代较为复杂的 iptables。 LLStack 无面板版使用的是 Firewall。")]),t._v(" "),a("h3",{attrs:{id:"开启端口-2"}},[t._v("开启端口")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("firewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("/tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v("\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("443")]),t._v("/tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v("\n")])])]),a("p",[t._v("这里的 "),a("code",[t._v("80")]),t._v(","),a("code",[t._v("443")]),t._v(" 即要开启的端口，我们可以自定义。")]),t._v(" "),a("h3",{attrs:{id:"关闭端口-2"}},[t._v("关闭端口")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("firewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --remove-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v("/tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v("\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --remove-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("443")]),t._v("/tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v("\n")])])]),a("h3",{attrs:{id:"批量添加区间端口-2"}},[t._v("批量添加区间端口")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("firewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4400")]),t._v("-4600/udp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v("\nfirewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--zone")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("public --add-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("4400")]),t._v("-4600/tcp "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--permanent")]),t._v("\n")])])]),a("h3",{attrs:{id:"重启防火墙"}},[t._v("重启防火墙")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("firewall-cmd "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("--reload")]),t._v(" // 重载\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("service")]),t._v(" firewalld restart // 重启\n")])])]),a("h3",{attrs:{id:"禁用防火墙"}},[t._v("禁用防火墙")]),t._v(" "),a("div",{staticClass:"language-bash extra-class"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[t._v("systemctl stop firewalld // 纯禁用\nsystemctl disable firewalld // 禁止开机启动\n")])])]),a("h2",{attrs:{id:"需要的端口"}},[t._v("需要的端口")]),t._v(" "),a("p",[a("strong",[t._v("LLStack/OLStack 需要开放的端口：")])]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("服务器名称")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("开放端口")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("推荐开放ip")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("备注")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("HTTP")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("80")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("0.0.0.0/0  ::/0")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("HTTPS")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("443")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("0.0.0.0/0  ::/0")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}})]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("LiteSpeed Web Admin")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("7080")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("自己的ip")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("建议将默认的7080更换为自定义端口")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("SSH")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("22")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("自己的ip")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("建议将默认的22更换为自定义端口")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("MySQL")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("3306")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("服务器内网IP")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("站库分离时使用，若不分离无需开启")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("Redis")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("6379")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("服务器内网IP")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("站库分离时使用，若不分离无需开启")])])])]),t._v(" "),a("p",[t._v("安全起见建议将 LiteSpeed Web Admin 和 SSH 改为非标准端口。")])])}),[],!1,null,null,null);a.default=r.exports}}]);