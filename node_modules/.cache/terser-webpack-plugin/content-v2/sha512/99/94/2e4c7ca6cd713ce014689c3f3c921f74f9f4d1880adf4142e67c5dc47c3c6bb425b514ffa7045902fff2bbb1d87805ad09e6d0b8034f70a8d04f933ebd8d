{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{212:function(e,t,_){\"use strict\";_.r(t);var n=_(0),o=Object(n.a)({},(function(){var e=this,t=e.$createElement,_=e._self._c||t;return _(\"ContentSlotsDistributor\",{attrs:{\"slot-key\":e.$parent.slotKey}},[_(\"h1\",{attrs:{id:\"启用-waf-规则\"}},[_(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#启用-waf-规则\"}},[e._v(\"#\")]),e._v(\" 启用 WAF 规则\")]),e._v(\" \"),_(\"p\",[e._v(\"在 LSWS Web Admin 控制台中，有一个**Web应用程序防火墙（WAF）**部分，它允许启用 Mod_Security 并在LSWS本机服务器上添加规则集。\")]),e._v(\" \"),_(\"p\",[e._v(\"导航到  \"),_(\"strong\",[e._v(\"Server > Security\")])]),e._v(\" \"),_(\"p\",[_(\"img\",{attrs:{src:\"https://pics.mf8.biz/picgo20190225145731.png\",alt:\"\"}})]),e._v(\" \"),_(\"p\",[e._v(\"在 \"),_(\"strong\",[e._v(\"Web Application Firewall (WAF)\")]),e._v(\" 部分中，您可以选择是否启用“ \"),_(\"strong\",[e._v(\"请求内容深度检查”\")]),e._v(\"。此功能等同于Apache的ModSecurity，它可用于通过将请求与已知签名进行匹配来检测和阻止具有恶意的请求。\")]),e._v(\" \"),_(\"p\",[e._v(\"您可以选择许多规则集，例如：\")]),e._v(\" \"),_(\"ul\",[_(\"li\",[e._v(\"OWASP\")]),e._v(\" \"),_(\"li\",[e._v(\"Comodo\")]),e._v(\" \"),_(\"li\",[e._v(\"Atomicorp\")]),e._v(\" \"),_(\"li\",[e._v(\"Imunify360\")])]),e._v(\" \"),_(\"p\",[e._v(\"LSWS 与这些规则集兼容，当然也支持其他的 Mod_Security 规则集，如果熟悉制作ModSecurity规则集，也可以定义自己的规则。\")]),e._v(\" \"),_(\"p\",[_(\"strong\",[e._v(\"让我们看一下如何使用 Comodo 作为示例启用 Mod_Security 规则集。\")])]),e._v(\" \"),_(\"p\",[_(\"a\",{attrs:{href:\"https://waf.comodo.com/\",target:\"_blank\",rel:\"noopener noreferrer\"}},[e._v(\"Comodo\"),_(\"OutboundLink\")],1),e._v(\"是由Comodo团队创建的Mod_Security规则集。它为LiteSpeed Web Server上运行的Web应用程序提供实时保护。其功能包括：\")]),e._v(\" \"),_(\"ul\",[_(\"li\",[e._v(\"保护敏感的客户数据\")]),e._v(\" \"),_(\"li\",[e._v(\"满足PCI合规性要求\")]),e._v(\" \"),_(\"li\",[e._v(\"阻止未经授权的访问\")]),e._v(\" \"),_(\"li\",[e._v(\"防止SQL注入和跨站点脚本（XSS）攻击\")])]),e._v(\" \"),_(\"h2\",{attrs:{id:\"下载和提取规则\"}},[_(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#下载和提取规则\"}},[e._v(\"#\")]),e._v(\" 下载和提取规则\")]),e._v(\" \"),_(\"p\",[e._v(\"首先，下载与Litespeed兼容的Comodo规则。\")]),e._v(\" \"),_(\"div\",{staticClass:\"language-bash extra-class\"},[_(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[_(\"code\",[_(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[e._v(\"cd\")]),e._v(\" /usr/local/lsws/conf\\n\"),_(\"span\",{pre:!0,attrs:{class:\"token function\"}},[e._v(\"wget\")]),e._v(\" https://waf.comodo.com/api/cpanel_litespeed_vendor\\n\"),_(\"span\",{pre:!0,attrs:{class:\"token function\"}},[e._v(\"unzip\")]),e._v(\" cpanel_litespeed_vendor\\n\"),_(\"span\",{pre:!0,attrs:{class:\"token builtin class-name\"}},[e._v(\"cd\")]),e._v(\" comodo_litespeed/\\n\"),_(\"span\",{pre:!0,attrs:{class:\"token function\"}},[e._v(\"mv\")]),e._v(\" rules.conf.main rules.conf\\n\")])])]),_(\"p\",[e._v(\"上述步骤下载了 Comodo Litespeed 规则，并重命名 \"),_(\"code\",[e._v(\"rules.conf.main\")]),e._v(\"为\"),_(\"code\",[e._v(\"rules.conf\")]),e._v(\"。这是包含所有规则的主文件。我们可以在WebAdmin控制台中引用此主文件。\")]),e._v(\" \"),_(\"h2\",{attrs:{id:\"添加waf规则集\"}},[_(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#添加waf规则集\"}},[e._v(\"#\")]),e._v(\" 添加WAF规则集\")]),e._v(\" \"),_(\"p\",[e._v(\"导航到 \"),_(\"strong\",[e._v(\"Configuration > Server > Security > WAF Rule Set\")])]),e._v(\" \"),_(\"p\",[_(\"img\",{attrs:{src:\"https://pics.mf8.biz/picgo20190225145936.png\",alt:\"\"}})]),e._v(\" \"),_(\"p\",[e._v(\"单击 \"),_(\"strong\",[e._v(\"ADD\")]),e._v(\" 以编辑 \"),_(\"strong\",[e._v(\"WAF规则集\")]),e._v(\"。\")]),e._v(\" \"),_(\"p\",[_(\"img\",{attrs:{src:\"https://pics.mf8.biz/picgo20190225150228.png\",alt:\"\"}})]),e._v(\" \"),_(\"ul\",[_(\"li\",[_(\"strong\",[e._v(\"Name\")]),e._v(\": \"),_(\"code\",[e._v(\"Comodo Litespeed\")])]),e._v(\" \"),_(\"li\",[_(\"strong\",[e._v(\"Action\")]),e._v(\": \"),_(\"code\",[e._v(\"None\")])]),e._v(\" \"),_(\"li\",[_(\"strong\",[e._v(\"Enabled\")]),e._v(\": \"),_(\"code\",[e._v(\"Yes\")])]),e._v(\" \"),_(\"li\",[_(\"strong\",[e._v(\"Rules Definition\")]),e._v(\": \"),_(\"code\",[e._v(\"Include $SERVER_ROOT/conf/comodo_litespeed/rules.conf\")])])]),e._v(\" \"),_(\"p\",[e._v(\"单击  \"),_(\"strong\",[e._v(\"Save\")]),e._v(\" 以激活规则。\")]),e._v(\" \"),_(\"p\",[e._v(\"可以在 \"),_(\"strong\",[e._v(\"Rules Definition\")]),e._v(\" 区域中包含任意数量的规则文件。\")]),e._v(\" \"),_(\"p\",[e._v(\"我们输入的文件 \"),_(\"code\",[e._v(\"rules.conf\")]),e._v(\" 是 Comodo 主文件，按顺序包含所有规则。它与手动输入以下内容相同（需要再加上文件所在物理路径前缀）：\")]),e._v(\" \"),_(\"div\",{staticClass:\"language- extra-class\"},[_(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[_(\"code\",[e._v(\"Include 00_Init_Initialization.conf\\nInclude 01_Init_AppsInitialization.conf\\nInclude 02_Global_Generic.conf\\nInclude 03_Global_Agents.conf\\nInclude 04_Global_Domains.conf\\nInclude 05_Global_Incoming.conf\\nInclude 06_Global_Backdoor.conf\\nInclude 07_XSS_XSS.conf\\nInclude 08_Global_Other.conf\\nInclude 09_Bruteforce_Bruteforce.conf\\nInclude 10_HTTP_HTTP.conf\\nInclude 11_HTTP_HTTPDoS.conf\\nInclude 12_HTTP_Protocol.conf\\nInclude 13_HTTP_Request.conf\\nInclude 14_Outgoing_FilterGen.conf\\nInclude 15_Outgoing_FilterASP.conf\\nInclude 16_Outgoing_FilterPHP.conf\\nInclude 17_Outgoing_FilterSQL.conf\\nInclude 18_Outgoing_FilterOther.conf\\nInclude 19_Outgoing_FilterInFrame.conf\\nInclude 20_Outgoing_FiltersEnd.conf\\nInclude 21_PHP_PHPGen.conf\\nInclude 22_SQL_SQLi.conf\\nInclude 23_ROR_RORGen.conf\\nInclude 24_Apps_Joomla.conf\\nInclude 25_Apps_JComponent.conf\\nInclude 26_Apps_WordPress.conf\\nInclude 27_Apps_WPPlugin.conf\\nInclude 28_Apps_WHMCS.conf\\nInclude 29_Apps_Drupal.conf\\nInclude 30_Apps_OtherApps.conf\\n\")])])]),_(\"p\",[e._v(\"如果使用一些商业规则集（如Atomic规则集）或您自己的规则集（没有这样的主文件），您有两个选择：\")]),e._v(\" \"),_(\"ul\",[_(\"li\",[e._v(\"在“ \"),_(\"strong\",[e._v(\"Rules Definition”\"),_(\"strong\",[e._v(\"字段中逐个包含绝对路径的\")]),e._v(\"规则\")]),e._v(\"。\")]),e._v(\" \"),_(\"li\",[e._v(\"创建一个主文件以包含具有完整路径的所有规则，然后在“ **Rules Definition”**字段中仅包含该主文件。\")])]),e._v(\" \"),_(\"p\",[e._v(\"如果包含mod_security的多个rul文件，则必须按正确的顺序包含这些文件，以使它们正常工作。\")]),e._v(\" \"),_(\"h2\",{attrs:{id:\"启用防火墙\"}},[_(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#启用防火墙\"}},[e._v(\"#\")]),e._v(\" 启用防火墙\")]),e._v(\" \"),_(\"p\",[e._v(\"导航到\"),_(\"strong\",[e._v(\"Configuration > Server > Security > Web Application Firewall (WAF)\")])]),e._v(\" \"),_(\"p\",[_(\"img\",{attrs:{src:\"https://pics.mf8.biz/picgo20190225150703.png\",alt:\"\"}})]),e._v(\" \"),_(\"ul\",[_(\"li\",[_(\"strong\",[e._v(\"Enable WAF\")]),e._v(\": \"),_(\"code\",[e._v(\"Yes\")])]),e._v(\" \"),_(\"li\",[_(\"strong\",[e._v(\"Log Level\")]),e._v(\": \"),_(\"code\",[e._v(\"0\")])]),e._v(\" \"),_(\"li\",[_(\"strong\",[e._v(\"Default Action\")]),e._v(\": \"),_(\"code\",[e._v(\"deny,log,status:403\")])]),e._v(\" \"),_(\"li\",[_(\"strong\",[e._v(\"Scan Request Body\")]),e._v(\": \"),_(\"code\",[e._v(\"Yes\")]),e._v(\" (If set to \"),_(\"code\",[e._v(\"Yes\")]),e._v(\" will scan post request body)\")]),e._v(\" \"),_(\"li\",[_(\"strong\",[e._v(\"Temporary File Path\")]),e._v(\": \"),_(\"code\",[e._v(\"/tmp\")])]),e._v(\" \"),_(\"li\",[_(\"strong\",[e._v(\"Disable .htaccess Override\")]),e._v(\": \"),_(\"code\",[e._v(\"Not Set\")])]),e._v(\" \"),_(\"li\",[_(\"strong\",[e._v(\"Enable Security Audit Log\")]),e._v(\": \"),_(\"code\",[e._v(\"Not Set\")])]),e._v(\" \"),_(\"li\",[_(\"strong\",[e._v(\"Security Audit Log\")]),e._v(\": \"),_(\"code\",[e._v(\"$SERVER_ROOT/logs/security_audit.log\")])])]),e._v(\" \"),_(\"p\",[e._v(\"单击“ **Save”**以启用防火墙，然后执行 “\"),_(\"strong\",[e._v(\"Graceful Restart.\")]),e._v(\"” 即 重启 LiteSpeed。\")]),e._v(\" \"),_(\"h2\",{attrs:{id:\"测试modsecurity规则集\"}},[_(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#测试modsecurity规则集\"}},[e._v(\"#\")]),e._v(\" 测试ModSecurity规则集\")]),e._v(\" \"),_(\"h3\",{attrs:{id:\"方法1\"}},[_(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#方法1\"}},[e._v(\"#\")]),e._v(\" 方法1\")]),e._v(\" \"),_(\"p\",[e._v(\"要检查CWAF是否有保护，请发送此请求：\")]),e._v(\" \"),_(\"div\",{staticClass:\"language-bash extra-class\"},[_(\"pre\",{pre:!0,attrs:{class:\"language-bash\"}},[_(\"code\",[e._v(\"http://\"),_(\"span\",{pre:!0,attrs:{class:\"token variable\"}},[e._v(\"$server_domain\")]),e._v(\"/?a\"),_(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\"=\")]),e._v(\"b AND \"),_(\"span\",{pre:!0,attrs:{class:\"token assign-left variable\"}},[e._v(\"1\")]),_(\"span\",{pre:!0,attrs:{class:\"token operator\"}},[e._v(\"=\")]),_(\"span\",{pre:!0,attrs:{class:\"token number\"}},[e._v(\"1\")]),e._v(\"\\n\")])])]),_(\"p\",[e._v(\"如果它正常工作，服务器应该响应403状态代码。\")]),e._v(\" \"),_(\"p\",[_(\"img\",{attrs:{src:\"https://pics.mf8.biz/picgo20190225151248.png\",alt:\"\"}})]),e._v(\" \"),_(\"h3\",{attrs:{id:\"方法2：\"}},[_(\"a\",{staticClass:\"header-anchor\",attrs:{href:\"#方法2：\"}},[e._v(\"#\")]),e._v(\" 方法2：\")]),e._v(\" \"),_(\"p\",[e._v(\"您可以通过发送GET或POST请求参数来检查CWAF是否正常工作 \"),_(\"code\",[e._v(\"cwaf_test_request=a12875a9e62e1ecbcd1dded1879ab06949566276\")])]),e._v(\" \"),_(\"p\",[e._v(\"像这样：\")]),e._v(\" \"),_(\"div\",{staticClass:\"language- extra-class\"},[_(\"pre\",{pre:!0,attrs:{class:\"language-text\"}},[_(\"code\",[e._v(\"http://$server_domain/?cwaf_test_request=a12875a9e62e1ecbcd1dded1879ab06949566276\\n\")])])]),_(\"p\",[e._v(\"如果Web服务器返回403 Forbidden状态，则CWAF正常工作。\")])])}),[],!1,null,null,null);t.default=o.exports}}]);","extractedComments":[]}